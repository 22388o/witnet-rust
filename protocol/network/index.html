



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://docs.witnet.io/protocol/network/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>Network messages - Witnet-rust Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.451f80e5.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.22915126.css">
      
      
        
        
        <meta name="theme-color" content="#795548">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="brown" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../#witnet-network-protocol" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.witnet.io" title="Witnet-rust Documentation" class="md-header-nav__button md-logo">
          
            <img src="../../assets/images/logo.svg" alt="Witnet Logo" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Witnet-rust Documentation
              </span>
              <span class="md-header-nav__topic">
                Network messages
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/witnet/witnet-rust/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      witnet/witnet-rust
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.witnet.io" title="Witnet-rust Documentation" class="md-nav__button md-logo">
      
        <img src="../../assets/images/logo.svg" alt="Witnet Logo" width="48" height="48">
      
    </a>
    Witnet-rust Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/witnet/witnet-rust/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      witnet/witnet-rust
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Get started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Get started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/what-is-witnet/" title="What is Witnet" class="md-nav__link">
      What is Witnet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/why-rust/" title="Why Rust?" class="md-nav__link">
      Why Rust?
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/design-overview.md" title="Design Overview" class="md-nav__link">
      Design Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../get-started/install.md" title="Install" class="md-nav__link">
      Install
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Protocol
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Protocol
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Network messages
      </label>
    
    <a href="./" title="Network messages" class="md-nav__link md-nav__link--active">
      Network messages
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initial-considerations" title="Initial considerations" class="md-nav__link">
    Initial considerations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peer-bootstrapping-methods" title="Peer bootstrapping methods" class="md-nav__link">
    Peer bootstrapping methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constants-and-defaults" title="Constants and Defaults" class="md-nav__link">
    Constants and Defaults
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-values" title="Default Values" class="md-nav__link">
    Default Values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#witnet-versions" title="Witnet versions" class="md-nav__link">
    Witnet versions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magic-numbers" title="Magic numbers" class="md-nav__link">
    Magic numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-capabilities" title="Node capabilities" class="md-nav__link">
    Node capabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-agents" title="User agents" class="md-nav__link">
    User agents
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-structures" title="Common Structures" class="md-nav__link">
    Common Structures
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#address-format" title="Address Format" class="md-nav__link">
    Address Format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messages" title="Messages" class="md-nav__link">
    Messages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-header" title="Message Header" class="md-nav__link">
    Message Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handshake-version-verack" title="Handshake (VERSION, VERACK)" class="md-nav__link">
    Handshake (VERSION, VERACK)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peer-discovery-get_peers-peers" title="Peer discovery (GET_PEERS, PEERS)" class="md-nav__link">
    Peer discovery (GET_PEERS, PEERS)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heartbeat-ping-pong" title="Heartbeat (PING, PONG)" class="md-nav__link">
    Heartbeat (PING, PONG)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-messages" title="Error messages" class="md-nav__link">
    Error messages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Data requests
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Data requests
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-2" type="checkbox" id="nav-3-2-2">
    
    <label class="md-nav__link" for="nav-3-2-2">
      RADON
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-2">
        RADON
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/encoding/" title="Encoding" class="md-nav__link">
      Encoding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-2-2" type="checkbox" id="nav-3-2-2-2">
    
    <label class="md-nav__link" for="nav-3-2-2-2">
      Data types
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-2-2-2">
        Data types
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/array/" title="Array<V>" class="md-nav__link">
      Array<V>
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/boolean/" title="Boolean" class="md-nav__link">
      Boolean
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/int/" title="Int" class="md-nav__link">
      Int
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/float/" title="Float" class="md-nav__link">
      Float
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/map/" title="Map<V>" class="md-nav__link">
      Map<V>
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/mixed/" title="Mixed" class="md-nav__link">
      Mixed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/null/" title="Null" class="md-nav__link">
      Null
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/result/" title="Result<V>" class="md-nav__link">
      Result<V>
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/types/string/" title="String" class="md-nav__link">
      String
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/wrapping/" title="Implicit `Result<V>` wrapping" class="md-nav__link">
      Implicit `Result<V>` wrapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/exceptions/" title="Exception handling" class="md-nav__link">
      Exception handling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/functions/" title="Predefined functions" class="md-nav__link">
      Predefined functions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/subscripts/" title="Subscripts" class="md-nav__link">
      Subscripts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radon/constants/" title="Constants" class="md-nav__link">
      Constants
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-requests/radlang.md" title="RADlang" class="md-nav__link">
      RADlang
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Transactions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Transactions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../transactions.md" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../witscript.md" title="WitScript" class="md-nav__link">
      WitScript
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../blocks.md" title="Blocks" class="md-nav__link">
      Blocks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reputation.md" title="Reputation" class="md-nav__link">
      Reputation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mining.md" title="Mining" class="md-nav__link">
      Mining
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../task-assignment.md" title="Task assignment" class="md-nav__link">
      Task assignment
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Architecture
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Architecture
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/overview.md" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Peer-To-Peer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Peer-To-Peer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/p2p/connections.md" title="Connections" class="md-nav__link">
      Connections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/p2p/gossip.md" title="Gossiping" class="md-nav__link">
      Gossiping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/p2p/encoding.md" title="Encoding (FlatBuffers)" class="md-nav__link">
      Encoding (FlatBuffers)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/storage/" title="Persistent Storage" class="md-nav__link">
      Persistent Storage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" type="checkbox" id="nav-4-4">
    
    <label class="md-nav__link" for="nav-4-4">
      Managers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-4">
        Managers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/managers/storage-manager/" title="Storage Manager" class="md-nav__link">
      Storage Manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/managers/peers-manager/" title="Peers Manager" class="md-nav__link">
      Peers Manager
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/mempool-mgmt.md" title="Mempool Management" class="md-nav__link">
      Mempool Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/block-mgmt.md" title="Block Management" class="md-nav__link">
      Block Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/utxo-mgmt.md" title="UTXO Management" class="md-nav__link">
      UTXO Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-8" type="checkbox" id="nav-4-8">
    
    <label class="md-nav__link" for="nav-4-8">
      Data Requests
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-8">
        Data Requests
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/rad/overview.md" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/witscript.md" title="Witscript Parser" class="md-nav__link">
      Witscript Parser
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Advanced
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/constants.md" title="Network constants" class="md-nav__link">
      Network constants
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../advanced/whitepaper-differences.md" title="Differences with the whitepaper" class="md-nav__link">
      Differences with the whitepaper
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../roadmap.md" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../contributing/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../development/" title="Development" class="md-nav__link">
      Development
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../glossary.md" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#initial-considerations" title="Initial considerations" class="md-nav__link">
    Initial considerations
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peer-bootstrapping-methods" title="Peer bootstrapping methods" class="md-nav__link">
    Peer bootstrapping methods
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#constants-and-defaults" title="Constants and Defaults" class="md-nav__link">
    Constants and Defaults
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-values" title="Default Values" class="md-nav__link">
    Default Values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#witnet-versions" title="Witnet versions" class="md-nav__link">
    Witnet versions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#magic-numbers" title="Magic numbers" class="md-nav__link">
    Magic numbers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-capabilities" title="Node capabilities" class="md-nav__link">
    Node capabilities
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-agents" title="User agents" class="md-nav__link">
    User agents
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#common-structures" title="Common Structures" class="md-nav__link">
    Common Structures
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#address-format" title="Address Format" class="md-nav__link">
    Address Format
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#messages" title="Messages" class="md-nav__link">
    Messages
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#message-header" title="Message Header" class="md-nav__link">
    Message Header
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handshake-version-verack" title="Handshake (VERSION, VERACK)" class="md-nav__link">
    Handshake (VERSION, VERACK)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peer-discovery-get_peers-peers" title="Peer discovery (GET_PEERS, PEERS)" class="md-nav__link">
    Peer discovery (GET_PEERS, PEERS)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heartbeat-ping-pong" title="Heartbeat (PING, PONG)" class="md-nav__link">
    Heartbeat (PING, PONG)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#error-messages" title="Error messages" class="md-nav__link">
    Error messages
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" title="References" class="md-nav__link">
    References
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/witnet/witnet-rust/blob/master/docs/protocol/network.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="witnet-network-protocol">Witnet Network Protocol<a class="headerlink" href="#witnet-network-protocol" title="Permanent link">&para;</a></h1>
<p>Witnet network protocol is inspired in other blockchain network protocols such as Bitcoin, Ethereum and Rchain. Additionally, other blockchains such as Grin and Exonum have been taken into consideration as their reference implementations are coded in Rust.</p>
<h2 id="initial-considerations">Initial considerations<a class="headerlink" href="#initial-considerations" title="Permanent link">&para;</a></h2>
<p>In order to start the network discovery process, at least one existing node on the network is required. However, in order to avoid unnecessary risks or potential attack vectors, it is always recommended to know several existing nodes extracted from different sources.</p>
<h3 id="peer-bootstrapping-methods">Peer bootstrapping methods<a class="headerlink" href="#peer-bootstrapping-methods" title="Permanent link">&para;</a></h3>
<p>The strategy for selecting the first node to connect should be random, thus it should not depend on geographical position or any other network parameter.</p>
<p>The client discovers the IP addresses and ports of other nodes in a decentralized way, i.e. there should not be a central point of trust or failure to bootstrap the network.</p>
<p>For example, some of the considered approaches for bootstrapping a new peer into the network could one or more of the following methods:</p>
<ul>
<li>Hard coded addresses</li>
<li>Addresses provided as command line arguments</li>
<li>Addresses provided from user provided text file on startup</li>
<li>Store addresses in database and read them on startup</li>
<li>Exchange addresses with other nodes</li>
<li>DNS requests to receive IP addresses</li>
<li>IRC channel where peers are advertised</li>
</ul>
<h2 id="constants-and-defaults">Constants and Defaults<a class="headerlink" href="#constants-and-defaults" title="Permanent link">&para;</a></h2>
<p>Witnet constants and default values used in the network protocol.</p>
<h3 id="default-values">Default Values<a class="headerlink" href="#default-values" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Network</th>
<th align="center">Default Port</th>
</tr>
</thead>
<tbody>
<tr>
<td>mainnet</td>
<td align="center">11337</td>
</tr>
<tr>
<td>testnet</td>
<td align="center">21337</td>
</tr>
</tbody>
</table>
<h3 id="witnet-versions">Witnet versions<a class="headerlink" href="#witnet-versions" title="Permanent link">&para;</a></h3>
<p>Below the existing versions of the Witnet P2P network protocol are listed:</p>
<table>
<thead>
<tr>
<th>Version</th>
<th>Initial Release</th>
<th>Major Changes</th>
</tr>
</thead>
<tbody>
<tr>
<td>010</td>
<td>to be determined</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="magic-numbers">Magic numbers<a class="headerlink" href="#magic-numbers" title="Permanent link">&para;</a></h3>
<p>These constant values indicate the originating network in the message headers:</p>
<table>
<thead>
<tr>
<th>Network</th>
<th align="center">Magic number</th>
</tr>
</thead>
<tbody>
<tr>
<td>mainnet</td>
<td align="center">0x00</td>
</tr>
<tr>
<td>testnet</td>
<td align="center">0xF0</td>
</tr>
</tbody>
</table>
<h3 id="node-capabilities">Node capabilities<a class="headerlink" href="#node-capabilities" title="Permanent link">&para;</a></h3>
<p>Currently, only one node capabilities is being offered by Witnet:</p>
<table>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0000000000000001</td>
<td>NODE_NETWORK, Witnet full node which is the default operation mode</td>
</tr>
</tbody>
</table>
<h3 id="user-agents">User agents<a class="headerlink" href="#user-agents" title="Permanent link">&para;</a></h3>
<p>Currently, only one user agent is being developed:</p>
<table>
<thead>
<tr>
<th>User Agent</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>/Witnet-rust:0.1.0</td>
<td>Witnet node implemented in Rust and version 0.1.0</td>
</tr>
</tbody>
</table>
<h2 id="common-structures">Common Structures<a class="headerlink" href="#common-structures" title="Permanent link">&para;</a></h2>
<p>Common structures used along different Witnet network messages.</p>
<h3 id="address-format">Address Format<a class="headerlink" href="#address-format" title="Permanent link">&para;</a></h3>
<p>Witnet peer addresses are defined as follows:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th align="center">Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ipv4</td>
<td align="center">u32</td>
<td>IPv4 address of the peer</td>
</tr>
<tr>
<td>port</td>
<td align="center">u16</td>
<td>port number in which the peer is listening</td>
</tr>
</tbody>
</table>
<p>Alternatively, IP addresses may be IPv6:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th align="center">Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ipv6</td>
<td align="center">[u32; 4]</td>
<td>IPv6 address of the peer</td>
</tr>
<tr>
<td>port</td>
<td align="center">u16</td>
<td>port number in which the peer is listening</td>
</tr>
</tbody>
</table>
<h2 id="messages">Messages<a class="headerlink" href="#messages" title="Permanent link">&para;</a></h2>
<p>The current network protocol includes the description and definition of the following messages:</p>
<ul>
<li>VERSION</li>
<li>VERACK</li>
<li>GET_PEERS</li>
<li>PEERS</li>
<li>PING</li>
<li>PONG</li>
</ul>
<p>All of these messages include a message header identifying which message type is being sent.</p>
<h3 id="message-header">Message Header<a class="headerlink" href="#message-header" title="Permanent link">&para;</a></h3>
<p>Inspired in other blockchains, the message header format is composed of the following fields:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th align="center">Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>magic</td>
<td align="center">u16</td>
<td>magic value indicating message origin network</td>
</tr>
<tr>
<td>command</td>
<td align="center">string</td>
<td>message being sent from a predefined list of available commands</td>
</tr>
<tr>
<td>payload</td>
<td align="center">?</td>
<td>message data</td>
</tr>
</tbody>
</table>
<h3 id="handshake-version-verack">Handshake (VERSION, VERACK)<a class="headerlink" href="#handshake-version-verack" title="Permanent link">&para;</a></h3>
<p>The protocol to connect from a local peer (initiator) to a known remote peer, also known as "handshake", starts with a TCP connection to a given IP address and port.</p>
<p>The handshake initiator, the local peer, sends a <code class="codehilite">version</code> message to the remote peer.
The remote peer will analyze the information in order to evaluate if the submitting peer is compatible regarding their supported versions and capabilities. If so, the remote peer will acknowledge the <code class="codehilite">version</code> message and establish a connection by sending a <code class="codehilite">verack</code> message.</p>
<p>The <code class="codehilite">version</code> message contains the following information:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th align="center">Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>version</td>
<td align="center">u32</td>
<td>the Witnet p2p protocol version that the client is using</td>
</tr>
<tr>
<td>timestamp</td>
<td align="center">u64</td>
<td>the current time in UTC format</td>
</tr>
<tr>
<td>capabilities</td>
<td align="center">u64</td>
<td>list of flags of supported services, by default NODE_NETWORK is used</td>
</tr>
<tr>
<td>sender_address</td>
<td align="center">addr</td>
<td>the IP address and port of the handshake initiator peer</td>
</tr>
<tr>
<td>receiver_address</td>
<td align="center">addr</td>
<td>the IP address and port of the remote peer</td>
</tr>
<tr>
<td>user_agent</td>
<td align="center">string</td>
<td>a version showing which software is running the local peer</td>
</tr>
<tr>
<td>last_epoch</td>
<td align="center">u32</td>
<td>last epoch in the local peer blockchain</td>
</tr>
<tr>
<td>genesis</td>
<td align="center">[u32; 8]</td>
<td>hash of the genesis block</td>
</tr>
<tr>
<td>nonce</td>
<td align="center">u64</td>
<td>Node random nonce, randomly generated every time a version packet is sent (used to detect connections to self)</td>
</tr>
</tbody>
</table>
<p>The <code class="codehilite">verack</code> message is sent as reply to the version and it only consists of a message header with the command <code class="codehilite">VERACK</code>.</p>
<p>Subsequently, the handshake initiator will expect a <code class="codehilite">version</code> message from the remote peer. The local peer will also acknowledge by replying with a <code class="codehilite">verack</code> message.</p>
<p>Connection cannot be considered as establish until both <code class="codehilite">verack</code> messages have been received by both peers.</p>
<p>After sending a <code class="codehilite">version</code> message the peers will define a timeout to wait for a response. If no response is received during this timeout (usually set to 10 seconds), the peer will be discarded from the known peers list.</p>
<h3 id="peer-discovery-get_peers-peers">Peer discovery (GET_PEERS, PEERS)<a class="headerlink" href="#peer-discovery-get_peers-peers" title="Permanent link">&para;</a></h3>
<p>In Witnet, a node must always establish different paths into the network by connecting to different peers, ideally randomly selected. As connections may disappear, network peers should assist others when they bootstrap.</p>
<p>After establishing a connection with remote peers (throughout a handshake mechanism), a node may request to their remote peer to receive a list of their known "recent" peers. This request is initiated by sending a <code class="codehilite">get_peers</code> message to a remote peer. The receiving node will reply with a <code class="codehilite">peers</code> message with a list of peer addresses that have been seen recently active in the network. The typical assumption is that a node is likely to be active if it has sent any message during the last 90 minutes. The transmitting node will then update those IP addresses and ports into its database of available nodes.</p>
<p>The <code class="codehilite">get_peers</code> message only consists of the message header with the command <code class="codehilite">GET_PEERS</code>.</p>
<p>The <code class="codehilite">peers</code> message consists of the message header with the command <code class="codehilite">PEERS</code> and as payload it contains a list of known peers as:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th align="center">Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>peers</td>
<td align="center">addr[]</td>
<td>list of addresses of active known peers</td>
</tr>
</tbody>
</table>
<h3 id="heartbeat-ping-pong">Heartbeat (PING, PONG)<a class="headerlink" href="#heartbeat-ping-pong" title="Permanent link">&para;</a></h3>
<p>As in Bitcoin, the heartbeat protocol is defined with <code class="codehilite">ping</code> and <code class="codehilite">pong</code> messages and it is defined as follows:</p>
<ul>
<li>If during the last 30 minutes a peer has no transmitted any message, it will send a heartbeat as <code class="codehilite">ping</code> message.</li>
<li>If in the last 90 minutes no message has been received by a remote peer, the local node will assume that the connection has been closed.</li>
</ul>
<p>The <code class="codehilite">ping</code> message confirms that the connection is still valid. The <code class="codehilite">pong</code> message is sent in response to a <code class="codehilite">ping</code> message. Both contain only one field:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th align="center">Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>nonce</td>
<td align="center">u64</td>
<td>a random number</td>
</tr>
</tbody>
</table>
<h3 id="error-messages">Error messages<a class="headerlink" href="#error-messages" title="Permanent link">&para;</a></h3>
<p>The <code class="codehilite">error</code> messages are structured as follow:</p>
<table>
<thead>
<tr>
<th>Field</th>
<th align="center">Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td align="center">u32</td>
<td>predefined error code</td>
</tr>
<tr>
<td>message</td>
<td align="center">string</td>
<td>user friendly message</td>
</tr>
</tbody>
</table>
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<p>Bitcoin:</p>
<ul>
<li><a href="https://bitcoin.org/en/developer-reference">Developer Reference - Bitcoin</a></li>
<li><a href="https://en.bitcoin.it/wiki/">Wiki</a></li>
<li><a href="https://github.com/bitcoin/bitcoin/">GitHub - bitcoin/bitcoin: Bitcoin Core integration/staging tree</a></li>
<li><a href="https://github.com/paritytech/parity-bitcoin/">GitHub - paritytech/parity-bitcoin: The Parity Bitcoin client</a></li>
</ul>
<p>Ethereum:</p>
<ul>
<li><a href="https://github.com/ethereum/wiki/wiki">Wiki · GitHub</a></li>
<li><a href="https://github.com/ethereum/go-ethereum">GitHub - ethereum/go-ethereum: Official Go implementation of the Ethereum protocol</a></li>
<li><a href="https://github.com/paritytech/parity-ethereum/">GitHub - paritytech/parity-ethereum: The fast, light, and robust EVM and WASM client.</a></li>
</ul>
<p>RChain:</p>
<ul>
<li><a href="https://developer.rchain.coop/documentation">Documentation</a></li>
<li><a href="https://github.com/rchain/rchain">GitHub - rchain/rchain</a></li>
</ul>
<p>Mimblewimble Grin:</p>
<ul>
<li><a href="https://grin-tech.org/">Grin, the Tech | Simple, privacy-focused, scalable MimbleWimble chain implementation.</a></li>
<li><a href="https://github.com/mimblewimble/docs/wiki">Wiki · GitHub</a></li>
<li><a href="https://github.com/mimblewimble/grin">GitHub - mimblewimble/grin: Minimal implementation of the MimbleWimble protocol.</a></li>
</ul>
<p>Exonum:</p>
<ul>
<li><a href="https://exonum.com/doc/">Exonum Documentation</a></li>
<li><a href="https://github.com/exonum/exonum">GitHub - exonum/exonum: An extensible open-source framework for creating private/permissioned blockchain applications</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../get-started/why-rust/" title="Why Rust?" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Why Rust?
              </span>
            </div>
          </a>
        
        
          <a href="../data-requests/overview/" title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Overview
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            © 2018 Witnet Foundation. Available under <a href="https://www.gnu.org/licenses/fdl-1.3.en.html" rel="license">GNU Free Documentation License v1.3</a>
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/witnet" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://reddit.com/r/witnet" class="md-footer-social__link fa fa-reddit"></a>
    
      <a href="https://twitter.com/witnet_io" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.583bbe55.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>